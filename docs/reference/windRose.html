<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Traditional wind rose plot and pollution rose variation — windRose • openair</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Traditional wind rose plot and pollution rose variation — windRose" />
<meta property="og:description" content="The traditional wind rose plot that plots wind speed and wind
direction by different intervals. The pollution rose applies the
same plot structure but substitutes other measurements, most
commonly a pollutant time series, for wind speed." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openair</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Traditional wind rose plot and pollution rose variation</h1>
    <small class="dont-index">Source: <a href='https://github.com/davidcarslaw/openair/blob/master/R/windRose.R'><code>R/windRose.R</code></a></small>
    <div class="hidden name"><code>windRose.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The traditional wind rose plot that plots wind speed and wind
direction by different intervals. The pollution rose applies the
same plot structure but substitutes other measurements, most
commonly a pollutant time series, for wind speed.</p>
    </div>

    <pre class="usage"><span class='fu'>windRose</span><span class='op'>(</span><span class='va'>mydata</span>, ws <span class='op'>=</span> <span class='st'>"ws"</span>, wd <span class='op'>=</span> <span class='st'>"wd"</span>, ws2 <span class='op'>=</span> <span class='cn'>NA</span>, wd2 <span class='op'>=</span> <span class='cn'>NA</span>,
  ws.int <span class='op'>=</span> <span class='fl'>2</span>, angle <span class='op'>=</span> <span class='fl'>30</span>, type <span class='op'>=</span> <span class='st'>"default"</span>, bias.corr <span class='op'>=</span> <span class='cn'>TRUE</span>, cols
  <span class='op'>=</span> <span class='st'>"default"</span>, grid.line <span class='op'>=</span> <span class='cn'>NULL</span>, width <span class='op'>=</span> <span class='fl'>1</span>, seg <span class='op'>=</span> <span class='cn'>NULL</span>, auto.text
  <span class='op'>=</span> <span class='cn'>TRUE</span>, breaks <span class='op'>=</span> <span class='fl'>4</span>, offset <span class='op'>=</span> <span class='fl'>10</span>, normalise <span class='op'>=</span> <span class='cn'>FALSE</span>, max.freq <span class='op'>=</span>
  <span class='cn'>NULL</span>, paddle <span class='op'>=</span> <span class='cn'>TRUE</span>, key.header <span class='op'>=</span> <span class='cn'>NULL</span>, key.footer <span class='op'>=</span> <span class='st'>"(m/s)"</span>,
  key.position <span class='op'>=</span> <span class='st'>"bottom"</span>, key <span class='op'>=</span> <span class='cn'>TRUE</span>, dig.lab <span class='op'>=</span> <span class='fl'>5</span>, statistic <span class='op'>=</span>
  <span class='st'>"prop.count"</span>, pollutant <span class='op'>=</span> <span class='cn'>NULL</span>, annotate <span class='op'>=</span> <span class='cn'>TRUE</span>, angle.scale <span class='op'>=</span>
  <span class='fl'>315</span>, border <span class='op'>=</span> <span class='cn'>NA</span>, <span class='va'>...</span><span class='op'>)</span>


  <span class='fu'>pollutionRose</span><span class='op'>(</span><span class='va'>mydata</span>, pollutant <span class='op'>=</span> <span class='st'>"nox"</span>, key.footer <span class='op'>=</span> <span class='va'>pollutant</span>,
  key.position <span class='op'>=</span> <span class='st'>"right"</span>, key <span class='op'>=</span> <span class='cn'>TRUE</span>, breaks <span class='op'>=</span> <span class='fl'>6</span>, paddle <span class='op'>=</span> <span class='cn'>FALSE</span>,
  seg <span class='op'>=</span> <span class='fl'>0.9</span>, normalise <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mydata</th>
      <td><p>A data frame containing fields <code>ws</code> and
<code>wd</code></p></td>
    </tr>
    <tr>
      <th>ws</th>
      <td><p>Name of the column representing wind speed.</p></td>
    </tr>
    <tr>
      <th>wd</th>
      <td><p>Name of the column representing wind direction.</p></td>
    </tr>
    <tr>
      <th>ws2</th>
      <td><p>The user can supply a second set of wind speed and wind
direction values with which the first can be compared. See
details below for full explanation.</p></td>
    </tr>
    <tr>
      <th>wd2</th>
      <td><p>see <code>ws2</code>.</p></td>
    </tr>
    <tr>
      <th>ws.int</th>
      <td><p>The Wind speed interval. Default is 2 m/s but for
low met masts with low mean wind speeds a value of 1 or 0.5 m/s
may be better. Note, this argument is superseded in
<code>pollutionRose</code>. See <code>breaks</code> below.</p></td>
    </tr>
    <tr>
      <th>angle</th>
      <td><p>Default angle of &#8220;spokes&#8221; is 30. Other
potentially useful angles are 45 and 10. Note that the width of
the wind speed interval may need adjusting using <code>width</code>.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code>type</code> determines how the data are split i.e.
  conditioned, and then plotted. The default is will produce a
  single plot using the entire data. Type can be one of the
  built-in types as detailed in <code>cutData</code> e.g.
  &#8220;season&#8221;, &#8220;year&#8221;, &#8220;weekday&#8221; and so on. For
  example, <code>type = "season"</code> will produce four plots --- one
  for each season.</p>
<p>It is also possible to choose <code>type</code> as another variable in
  the data frame. If that variable is numeric, then the data will
  be split into four quantiles (if possible) and labelled
  accordingly. If type is an existing character or factor
  variable, then those categories/levels will be used directly.
  This offers great flexibility for understanding the variation of
  different variables and how they depend on one another.</p>
<p>Type can be up length two e.g. <code>type = c("season",
  "weekday")</code> will produce a 2x2 plot split by season and day of
  the week. Note, when two types are provided the first forms the
  columns and the second the rows.</p></td>
    </tr>
    <tr>
      <th>bias.corr</th>
      <td><p>When <code>angle</code> does not divide exactly into
360 a bias is introduced in the frequencies when the wind
direction is already supplied rounded to the nearest 10 degrees,
as is often the case. For example, if <code>angle = 22.5</code>, N, E,
S, W will include 3 wind sectors and all other angles will be
two. A bias correction can made to correct for this problem. A
simple method according to Applequist (2012) is used to adjust
the frequencies.</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>Colours to be used for plotting. Options include
&#8220;default&#8221;, &#8220;increment&#8221;, &#8220;heat&#8221;,
&#8220;jet&#8221;, &#8220;hue&#8221; and user defined. For user defined
the user can supply a list of colour names recognised by R (type
<code><a href='https://rdrr.io/r/grDevices/colors.html'>colours()</a></code> to see the full list). An example would be
<code>cols = c("yellow", "green", "blue", "black")</code>.</p></td>
    </tr>
    <tr>
      <th>grid.line</th>
      <td><p>Grid line interval to use. If <code>NULL</code>, as in
default, this is assigned by <code>windRose</code> based on the
available data range. However, it can also be forced to a
specific value, e.g. <code>grid.line = 10</code>. <code>grid.line</code> can
also be a list to control the interval, line type and colour.
For example <code>grid.line = list(value = 10, lty = 5, col =
"purple")</code>.</p></td>
    </tr>
    <tr>
      <th>width</th>
      <td><p>For <code>paddle = TRUE</code>, the adjustment factor for
width of wind speed intervals. For example, <code>width = 1.5</code>
will make the paddle width 1.5 times wider.</p></td>
    </tr>
    <tr>
      <th>seg</th>
      <td><p>For <code>pollutionRose</code> <code>seg</code> determines with
width of the segments. For example, <code>seg = 0.5</code> will
produce segments 0.5 * <code>angle</code>.</p></td>
    </tr>
    <tr>
      <th>auto.text</th>
      <td><p>Either <code>TRUE</code> (default) or <code>FALSE</code>. If
<code>TRUE</code> titles and axis labels will automatically try and
format pollutant names and units properly e.g.  by subscripting
the &#8216;2&#8217; in NO2.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>Most commonly, the number of break points for wind
speed in <code>windRose</code> or pollutant in <code>pollutionRose</code>.
For <code>windRose</code> and the <code>ws.int</code> default of 2 m/s, the
default, 4, generates the break points 2, 4, 6, 8 m/s. For
<code>pollutionRose</code>, the default, 6, attempts to breaks the
supplied data at approximately 6 sensible break points. However,
<code>breaks</code> can also be used to set specific break points. For
example, the argument <code>breaks = c(0, 1, 10, 100)</code> breaks
the data into segments &lt;1, 1-10, 10-100, &gt;100.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>The size of the 'hole' in the middle of the plot,
expressed as a percentage of the polar axis scale, default 10.</p></td>
    </tr>
    <tr>
      <th>normalise</th>
      <td><p>If <code>TRUE</code> each wind direction segment of a
pollution rose is normalised to equal one. This is useful for
showing how the concentrations (or other parameters) contribute
to each wind sector when the proprtion of time the wind is from
that direction is low. A line showing the probability that the
wind directions is from a particular wind sector is also shown.</p></td>
    </tr>
    <tr>
      <th>max.freq</th>
      <td><p>Controls the scaling used by setting the maximum
value for the radial limits. This is useful to ensure several
plots use the same radial limits.</p></td>
    </tr>
    <tr>
      <th>paddle</th>
      <td><p>Either <code>TRUE</code> (default) or <code>FALSE</code>. If
<code>TRUE</code> plots rose using `paddle' style spokes. If
<code>FALSE</code> plots rose using `wedge' style spokes.</p></td>
    </tr>
    <tr>
      <th>key.header</th>
      <td><p>Adds additional text/labels above and/or below
the scale key, respectively. For example, passing
<code>windRose(mydata, key.header = "ws")</code> adds the addition
text as a scale header. Note: This argument is passed to
<code>drawOpenKey</code> via <code>quickText</code>, applying the auto.text
argument, to handle formatting.</p></td>
    </tr>
    <tr>
      <th>key.footer</th>
      <td><p>see <code>key.footer</code>.</p></td>
    </tr>
    <tr>
      <th>key.position</th>
      <td><p>Location where the scale key is to plotted.
Allowed arguments currently include &#8220;top&#8221;,
&#8220;right&#8221;, &#8220;bottom&#8221; and &#8220;left&#8221;.</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>Fine control of the scale key via <code>drawOpenKey</code>.
See <code>drawOpenKey</code> for further details.</p></td>
    </tr>
    <tr>
      <th>dig.lab</th>
      <td><p>The number of signficant figures at which
scientific number formatting is used in break point and key
labelling. Default 5.</p></td>
    </tr>
    <tr>
      <th>statistic</th>
      <td><p>The <code>statistic</code> to be applied to each data
bin in the plot. Options currently include &#8220;prop.count&#8221;,
&#8220;prop.mean&#8221; and &#8220;abs.count&#8221;. The default
&#8220;prop.count&#8221; sizes bins according to the proportion of
the frequency of measurements.  Similarly, &#8220;prop.mean&#8221;
sizes bins according to their relative contribution to the mean.
&#8220;abs.count&#8221; provides the absolute count of measurements
in each bin.</p></td>
    </tr>
    <tr>
      <th>pollutant</th>
      <td><p>Alternative data series to be sampled instead of
wind speed. The <code>windRose</code> default NULL is equivalent to
<code>pollutant = "ws"</code>.</p></td>
    </tr>
    <tr>
      <th>annotate</th>
      <td><p>If <code>TRUE</code> then the percentage calm and mean
values are printed in each panel together with a description of
the statistic below the plot. If <code>" "</code> then only the 
stastic is below the plot. Custom annotations may be added by 
setting value to <code>c("annotation 1", "annotation 2")</code>.</p></td>
    </tr>
    <tr>
      <th>angle.scale</th>
      <td><p>The wind speed scale is by default shown at a
315 degree angle. Sometimes the placement of the scale may
interfere with an interesting feature. The user can therefore
set <code>angle.scale</code> to another value (between 0 and 360
degrees) to mitigate such problems. For example
<code>angle.scale = 45</code> will draw the scale heading in a NE
direction.</p></td>
    </tr>
    <tr>
      <th>border</th>
      <td><p>Border colour for shaded areas. Default is no
border.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>pollutionRose</code> other parameters that are
passed on to <code>windRose</code>. For <code>windRose</code> other
parameters that are passed on to <code>drawOpenKey</code>,
<code>lattice:xyplot</code> and <code>cutData</code>. Axis and title
labelling options (<code>xlab</code>, <code>ylab</code>, <code>main</code>) are
passed to <code>xyplot</code> via <code>quickText</code> to handle routine
formatting.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>As well as generating the plot itself, <code>windRose</code> and
  <code>pollutionRose</code> also return an object of class
  &#8220;openair&#8221;. The object includes three main components:
  <code>call</code>, the command used to generate the plot; <code>data</code>,
  the data frame of summarised information used to make the plot;
  and <code>plot</code>, the plot itself. If retained, e.g. using
  <code>output &lt;- windRose(mydata)</code>, this output can be used to
  recover the data, reproduce or rework the original plot or
  undertake further analysis.</p>
<p>An openair output can be manipulated using a number of generic
  operations, including <code>print</code>, <code>plot</code> and
  <code>summarise</code>.</p>
<p>Summarised proportions can also be extracted directly using the
  <code>$data</code> operator, e.g.  <code>object$data</code> for <code>output
  &lt;- windRose(mydata)</code>. This returns a data frame with three set
  columns: <code>cond</code>, conditioning based on <code>type</code>;
  <code>wd</code>, the wind direction; and <code>calm</code>, the
  <code>statistic</code> for the proportion of data unattributed to any
  specific wind direction because it was collected under calm
  conditions; and then several (one for each range binned for the
  plot) columns giving proportions of measurements associated with
  each <code>ws</code> or <code>pollutant</code> range plotted as a discrete
  panel.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For <code>windRose</code> data are summarised by direction, typically by
45 or 30 (or 10) degrees and by different wind speed categories.
Typically, wind speeds are represented by different width
"paddles". The plots show the proportion (here represented as a
percentage) of time that the wind is from a certain angle and wind
speed range.</p>
<p>By default <code>windRose</code> will plot a windRose in using "paddle"
style segments and placing the scale key below the plot.</p>
<p>The argument <code>pollutant</code> uses the same plotting structure but
substitutes another data series, defined by <code>pollutant</code>, for
wind speed.</p>
<p>The option <code>statistic = "prop.mean"</code> provides a measure of
the relative contribution of each bin to the panel mean, and is
intended for use with <code>pollutionRose</code>.</p>
<p><code>pollutionRose</code> is a <code>windRose</code> wrapper which brings
<code>pollutant</code> forward in the argument list, and attempts to
sensibly rescale break points based on the <code>pollutant</code> data
range by by-passing <code>ws.int</code>.</p>
<p>By default, <code>pollutionRose</code> will plot a pollution rose of
<code>nox</code> using "wedge" style segments and placing the scale key
to the right of the plot.</p>
<p>It is possible to compare two wind speed-direction data sets using
<code>pollutionRose</code>. There are many reasons for doing so e.g. to
see how one site compares with another or for meteorological model
evaluation. In this case, <code>ws</code> and <code>wd</code> are considered
to the the reference data sets with which a second set of wind
speed and wind directions are to be compared (<code>ws2</code> and
<code>wd2</code>). The first set of values is subtracted from the second
and the differences compared. If for example, <code>wd2</code> was
biased positive compared with <code>wd</code> then <code>pollutionRose</code>
will show the bias in polar coordinates. In its default use, wind
direction bias is colour-coded to show negative bias in one colour
and positive bias in another.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>windRose</code> and <code>pollutionRose</code> both use
  <a href='drawOpenKey.html'>drawOpenKey</a> to produce scale keys.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Applequist, S, 2012: Wind Rose Bias Correction. J. Appl. Meteor.
Climatol., 51, 1305-1309.</p>
<p>This paper seems to be the original?</p>
<p>Droppo,  J.G. and B.A. Napier (2008) Wind Direction Bias in
Generating Wind Roses and Conducting Sector-Based Air Dispersion
Modeling, Journal of the Air &amp; Waste Management Association, 58:7,
913-918.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See <code><a href='drawOpenKey.html'>drawOpenKey</a></code> for fine control of the
  scale key.</p>
<p>See <code><a href='polarFreq.html'>polarFreq</a></code> for a more flexible version that
  considers other statistics and pollutant concentrations.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>David Carslaw (with some additional contributions by Karl
  Ropkins)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='co'># load example data from package data(mydata)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># basic plot</span></span>
<span class='r-in'><span class='fu'>windRose</span><span class='op'>(</span><span class='va'>mydata</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='windRose-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># one windRose for each year</span></span>
<span class='r-in'><span class='fu'>windRose</span><span class='op'>(</span><span class='va'>mydata</span>,type <span class='op'>=</span> <span class='st'>"year"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='windRose-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># windRose in 10 degree intervals with gridlines and width adjusted</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='fu'>windRose</span><span class='op'>(</span><span class='va'>mydata</span>, angle <span class='op'>=</span> <span class='fl'>10</span>, width <span class='op'>=</span> <span class='fl'>0.2</span>, grid.line <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># pollutionRose of nox</span></span>
<span class='r-in'><span class='fu'>pollutionRose</span><span class='op'>(</span><span class='va'>mydata</span>, pollutant <span class='op'>=</span> <span class='st'>"nox"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='windRose-3.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## source apportionment plot - contribution to mean</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='fu'>pollutionRose</span><span class='op'>(</span><span class='va'>mydata</span>, pollutant <span class='op'>=</span> <span class='st'>"pm10"</span>, type <span class='op'>=</span> <span class='st'>"year"</span>, statistic <span class='op'>=</span> <span class='st'>"prop.mean"</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## example of comparing 2 met sites</span></span>
<span class='r-in'><span class='co'>## first we will make some new ws/wd data with a postive bias</span></span>
<span class='r-in'><span class='va'>mydata</span><span class='op'>$</span><span class='va'>ws2</span> <span class='op'>=</span> <span class='va'>mydata</span><span class='op'>$</span><span class='va'>ws</span> <span class='op'>+</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mydata</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span></span>
<span class='r-in'><span class='va'>mydata</span><span class='op'>$</span><span class='va'>wd2</span> <span class='op'>=</span> <span class='va'>mydata</span><span class='op'>$</span><span class='va'>wd</span> <span class='op'>+</span> <span class='fl'>30</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mydata</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>30</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## need to correct negative wd</span></span>
<span class='r-in'><span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>mydata</span><span class='op'>$</span><span class='va'>wd2</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>mydata</span><span class='op'>$</span><span class='va'>wd2</span><span class='op'>[</span><span class='va'>id</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>mydata</span><span class='op'>$</span><span class='va'>wd2</span><span class='op'>[</span><span class='va'>id</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>360</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## results show postive bias in wd and ws</span></span>
<span class='r-in'><span class='fu'>pollutionRose</span><span class='op'>(</span><span class='va'>mydata</span>, ws <span class='op'>=</span> <span class='st'>"ws"</span>, wd <span class='op'>=</span> <span class='st'>"wd"</span>, ws2 <span class='op'>=</span> <span class='st'>"ws2"</span>, wd2 <span class='op'>=</span> <span class='st'>"wd2"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='windRose-4.png' alt='' width='700' height='433' /></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


