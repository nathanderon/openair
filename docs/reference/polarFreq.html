<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Function to plot wind speed/direction frequencies and other statistics — polarFreq • openair</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Function to plot wind speed/direction frequencies and other statistics — polarFreq" />
<meta property="og:description" content="polarFreq primarily plots wind speed-direction frequencies in
&amp;#8216;bins&amp;#8217;. Each bin is colour-coded depending on the frequency of
measurements. Bins can also be used to show the concentration of pollutants
using a range of commonly used statistics." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openair</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to plot wind speed/direction frequencies and other statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/davidcarslaw/openair/blob/master/R/polarFreq.R'><code>R/polarFreq.R</code></a></small>
    <div class="hidden name"><code>polarFreq.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>polarFreq</code> primarily plots wind speed-direction frequencies in
&#8216;bins&#8217;. Each bin is colour-coded depending on the frequency of
measurements. Bins can also be used to show the concentration of pollutants
using a range of commonly used statistics.</p>
    </div>

    <pre class="usage"><span class='fu'>polarFreq</span><span class='op'>(</span>
  <span class='va'>mydata</span>,
  pollutant <span class='op'>=</span> <span class='st'>""</span>,
  statistic <span class='op'>=</span> <span class='st'>"frequency"</span>,
  ws.int <span class='op'>=</span> <span class='fl'>1</span>,
  wd.nint <span class='op'>=</span> <span class='fl'>36</span>,
  grid.line <span class='op'>=</span> <span class='fl'>5</span>,
  breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5000</span>, <span class='fl'>500</span><span class='op'>)</span>,
  cols <span class='op'>=</span> <span class='st'>"default"</span>,
  trans <span class='op'>=</span> <span class='cn'>TRUE</span>,
  type <span class='op'>=</span> <span class='st'>"default"</span>,
  min.bin <span class='op'>=</span> <span class='fl'>1</span>,
  ws.upper <span class='op'>=</span> <span class='cn'>NA</span>,
  offset <span class='op'>=</span> <span class='fl'>10</span>,
  border.col <span class='op'>=</span> <span class='st'>"transparent"</span>,
  key.header <span class='op'>=</span> <span class='va'>statistic</span>,
  key.footer <span class='op'>=</span> <span class='va'>pollutant</span>,
  key.position <span class='op'>=</span> <span class='st'>"right"</span>,
  key <span class='op'>=</span> <span class='cn'>TRUE</span>,
  auto.text <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mydata</th>
      <td><p>A data frame minimally containing <code>ws</code>, <code>wd</code> and
<code>date</code>.</p></td>
    </tr>
    <tr>
      <th>pollutant</th>
      <td><p>Mandatory. A pollutant name corresponding to a variable in
a data frame should be supplied e.g. <code>pollutant = "nox"</code></p></td>
    </tr>
    <tr>
      <th>statistic</th>
      <td><p>The statistic that should be applied to each wind
speed/direction bin. Can be &#8220;frequency&#8221;, &#8220;mean&#8221;,
&#8220;median&#8221;, &#8220;max&#8221; (maximum), &#8220;stdev&#8221; (standard
deviation) or &#8220;weighted.mean&#8221;. The option
&#8220;frequency&#8221; (the default) is the simplest and plots the
frequency of wind speed/direction in different bins. The scale
therefore shows the counts in each bin. The option &#8220;mean&#8221;
will plot the mean concentration of a pollutant (see next point)
in wind speed/direction bins, and so on.  Finally,
&#8220;weighted.mean&#8221; will plot the concentration of a pollutant
weighted by wind speed/direction. Each segment therefore provides
the percentage overall contribution to the total concentration.
More information is given in the examples. Note that for options
other than &#8220;frequency&#8221;, it is necessary to also provide the
name of a pollutant. See function <code>cutData</code> for further
details.</p></td>
    </tr>
    <tr>
      <th>ws.int</th>
      <td><p>Wind speed interval assumed. In some cases e.g. a low met
mast, an interval of 0.5 may be more appropriate.</p></td>
    </tr>
    <tr>
      <th>wd.nint</th>
      <td><p>Number of intervals of wind direction.</p></td>
    </tr>
    <tr>
      <th>grid.line</th>
      <td><p>Radial spacing of grid lines.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>The user can provide their own scale. <code>breaks</code> expects a
sequence of numbers that define the range of the scale. The sequence
could represent one with equal spacing e.g. <code>breaks = seq(0, 100,
10)</code> - a scale from 0-10 in intervals of 10, or a more flexible sequence
e.g. <code>breaks = c(0, 1, 5, 7, 10)</code>, which may be useful for some
situations.</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>Colours to be used for plotting. Options include
&#8220;default&#8221;, &#8220;increment&#8221;, &#8220;heat&#8221;, &#8220;jet&#8221;
and <code>RColorBrewer</code> colours --- see the <code>openair</code>
<code>openColours</code> function for more details. For user defined the
user can supply a list of colour names recognised by R (type
<code><a href='https://rdrr.io/r/grDevices/colors.html'>colours()</a></code> to see the full list). An example would be
<code>cols = c("yellow", "green", "blue")</code></p></td>
    </tr>
    <tr>
      <th>trans</th>
      <td><p>Should a transformation be applied? Sometimes when producing
plots of this kind they can be dominated by a few high points. The
default therefore is <code>TRUE</code> and a square-root transform is applied.
This results in a non-linear scale and (usually) a better representation
of the distribution. If set to <code>FALSE</code> a linear scale is used.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code>type</code> determines how the data are split
i.e. conditioned, and then plotted. The default is will produce a
single plot using the entire data. Type can be one of the built-in
types as detailed in <code>cutData</code> e.g. &#8220;season&#8221;,
&#8220;year&#8221;, &#8220;weekday&#8221; and so on. For example, <code>type
= "season"</code> will produce four plots --- one for each season.</p>
<p>It is also possible to choose <code>type</code> as another variable in
the data frame. If that variable is numeric, then the data will be
split into four quantiles (if possible) and labelled
accordingly. If type is an existing character or factor variable,
then those categories/levels will be used directly. This offers
great flexibility for understanding the variation of different
variables and how they depend on one another.</p>
<p>Type can be up length two e.g. <code>type = c("season", "weekday")</code> will
  produce a 2x2 plot split by season and day of the week. Note, when two
  types are provided the first forms the columns and the second the rows.</p></td>
    </tr>
    <tr>
      <th>min.bin</th>
      <td><p>The minimum number of points allowed in a wind speed/wind
direction bin.  The default is 1. A value of two requires at least 2
valid records in each bin an so on; bins with less than 2 valid records
are set to NA. Care should be taken when using a value &gt; 1 because of the
risk of removing real data points. It is recommended to consider your
data with care. Also, the <code>polarPlot</code> function can be of use in such
circumstances.</p></td>
    </tr>
    <tr>
      <th>ws.upper</th>
      <td><p>A user-defined upper wind speed to use. This is useful for
ensuring a consistent scale between different plots. For example, to
always ensure that wind speeds are displayed between 1-10, set
<code>ws.int = 10</code>.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p><code>offset</code> controls the size of the &#8216;hole&#8217;
in the middle and is expressed as a percentage of the maximum wind
speed. Setting a higher <code>offset</code> e.g. 50 is useful for
<code>statistic = "weighted.mean"</code> when <code>ws.int</code> is greater
than the maximum wind speed. See example below.</p></td>
    </tr>
    <tr>
      <th>border.col</th>
      <td><p>The colour of the boundary of each wind speed/direction
bin. The default is transparent. Another useful choice sometimes is
"white".</p></td>
    </tr>
    <tr>
      <th>key.header, key.footer</th>
      <td><p>Adds additional text/labels to the scale key.
For example, passing options <code>key.header = "header", key.footer =
"footer"</code> adds addition text above and below the scale key. These
arguments are passed to <code>drawOpenKey</code> via <code>quickText</code>, applying
the <code>auto.text</code> argument, to handle formatting.</p></td>
    </tr>
    <tr>
      <th>key.position</th>
      <td><p>Location where the scale key is to plotted.  Allowed
arguments currently include <code>"top"</code>, <code>"right"</code>, <code>"bottom"</code>
and <code>"left"</code>.</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>Fine control of the scale key via <code>drawOpenKey</code>. See
<code>drawOpenKey</code> for further details.</p></td>
    </tr>
    <tr>
      <th>auto.text</th>
      <td><p>Either <code>TRUE</code> (default) or <code>FALSE</code>. If
<code>TRUE</code> titles and axis labels will automatically try and format
pollutant names and units properly e.g.  by subscripting the &#8216;2&#8217;
in NO2.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other graphical parameters passed onto <code>lattice:xyplot</code>
and <code>cutData</code>. For example, <code>polarFreq</code> passes the option
<code>hemisphere = "southern"</code> on to <code>cutData</code> to provide southern
(rather than default northern) hemisphere handling of <code>type = "season"</code>.
Similarly, common axis and title labelling options (such as <code>xlab</code>,
<code>ylab</code>, <code>main</code>) are passed to <code>xyplot</code> via <code>quickText</code>
to handle routine formatting.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>As well as generating the plot itself, <code>polarFreq</code> also
  returns an object of class &#8220;openair&#8221;. The object includes three main
  components: <code>call</code>, the command used to generate the plot;
  <code>data</code>, the data frame of summarised information used to make the
  plot; and <code>plot</code>, the plot itself. If retained, e.g. using
  <code>output &lt;- polarFreq(mydata, "nox")</code>, this output can be used to
  recover the data, reproduce or rework the original plot or undertake
  further analysis.</p>
<p>An openair output can be manipulated using a number of generic operations,
  including <code>print</code>, <code>plot</code> and <code>summary</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>polarFreq</code> is its default use provides details of wind speed and
direction frequencies. In this respect it is similar to
<code><a href='windRose.html'>windRose</a></code>, but considers wind direction intervals of 10
degrees and a user-specified wind speed interval. The frequency of wind
speeds/directions formed by these &#8216;bins&#8217; is represented on a colour
scale.</p>
<p>The <code>polarFreq</code> function is more flexible than either
<code><a href='windRose.html'>windRose</a></code> or <code><a href='polarPlot.html'>polarPlot</a></code>. It can, for example,
also consider pollutant concentrations (see examples below). Instead of the
number of data points in each bin, the concentration can be shown. Further,
a range of statistics can be used to describe each bin - see
<code>statistic</code> above. Plotting mean concentrations is useful for source
identification and is the same as <code><a href='polarPlot.html'>polarPlot</a></code> but without
smoothing, which may be preferable for some data. Plotting with
<code>statistic = "weighted.mean"</code> is particularly useful for understanding
the relative importance of different source contributions. For example,
high mean concentrations may be observed for high wind speed conditions,
but the weighted mean concentration may well show that the contribution to
overall concentrations is very low.</p>
<p><code>polarFreq</code> also offers great flexibility with the scale used and the
user has fine control over both the range, interval and colour.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>~put references to the literature/web site here ~</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See Also as <code><a href='windRose.html'>windRose</a></code>, <code><a href='polarPlot.html'>polarPlot</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>David Carslaw</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># basic wind frequency plot</span></span>
<span class='r-in'><span class='fu'>polarFreq</span><span class='op'>(</span><span class='va'>mydata</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='polarFreq-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># wind frequencies by year</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>polarFreq</span><span class='op'>(</span><span class='va'>mydata</span>, type <span class='op'>=</span> <span class='st'>"year"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># mean SO2 by year, showing only bins with at least 2 points</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>polarFreq</span><span class='op'>(</span><span class='va'>mydata</span>, pollutant <span class='op'>=</span> <span class='st'>"so2"</span>, type <span class='op'>=</span> <span class='st'>"year"</span>, statistic <span class='op'>=</span> <span class='st'>"mean"</span>, min.bin <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># weighted mean SO2 by year, showing only bins with at least 2 points</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>polarFreq</span><span class='op'>(</span><span class='va'>mydata</span>, pollutant <span class='op'>=</span> <span class='st'>"so2"</span>, type <span class='op'>=</span> <span class='st'>"year"</span>, statistic <span class='op'>=</span> <span class='st'>"weighted.mean"</span>,</span>
<span class='r-in'>min.bin <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#windRose for just 2000 and 2003 with different colours</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>polarFreq</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>mydata</span>, <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='st'>"%Y"</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2000</span>, <span class='fl'>2003</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span class='r-in'>type <span class='op'>=</span> <span class='st'>"year"</span>, cols <span class='op'>=</span> <span class='st'>"jet"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># user defined breaks from 0-700 in intervals of 100 (note linear scale)</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>polarFreq</span><span class='op'>(</span><span class='va'>mydata</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>700</span>, <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># more complicated user-defined breaks - useful for highlighting bins</span></span>
<span class='r-in'><span class='co'># with a certain number of data points</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>polarFreq</span><span class='op'>(</span><span class='va'>mydata</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10</span>, <span class='fl'>50</span>, <span class='fl'>100</span>, <span class='fl'>250</span>, <span class='fl'>500</span>, <span class='fl'>700</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># source contribution plot and use of offset option</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>polarFreq</span><span class='op'>(</span><span class='va'>mydata</span>, pollutant <span class='op'>=</span> <span class='st'>"pm25"</span>, statistic</span>
<span class='r-in'><span class='op'>=</span><span class='st'>"weighted.mean"</span>, offset <span class='op'>=</span> <span class='fl'>50</span>, ws.int <span class='op'>=</span> <span class='fl'>25</span>, trans <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> </span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


