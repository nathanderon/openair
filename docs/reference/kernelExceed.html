<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Kernel density plot for daily mean exceedance statistics — kernelExceed • openair</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Kernel density plot for daily mean exceedance statistics — kernelExceed" />
<meta property="og:description" content="This function is used to explore the conditions leading to exeedances of
air quality limits. Currently the focus is on understanding the conditions
under which daily limit values for PM10 are in excess of a specified
threshold. Kernel density estimates are calculated and plotted to highlight
those conditions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openair</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kernel density plot for daily mean exceedance statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/davidcarslaw/openair/blob/master/R/kernelExceed.R'><code>R/kernelExceed.R</code></a></small>
    <div class="hidden name"><code>kernelExceed.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is used to explore the conditions leading to exeedances of
air quality limits. Currently the focus is on understanding the conditions
under which daily limit values for PM10 are in excess of a specified
threshold. Kernel density estimates are calculated and plotted to highlight
those conditions.</p>
    </div>

    <pre class="usage"><span class='fu'>kernelExceed</span><span class='op'>(</span>
  <span class='va'>polar</span>,
  x <span class='op'>=</span> <span class='st'>"wd"</span>,
  y <span class='op'>=</span> <span class='st'>"ws"</span>,
  pollutant <span class='op'>=</span> <span class='st'>"pm10"</span>,
  type <span class='op'>=</span> <span class='st'>"default"</span>,
  by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"day"</span>, <span class='st'>"dayhour"</span>, <span class='st'>"all"</span><span class='op'>)</span>,
  limit <span class='op'>=</span> <span class='fl'>50</span>,
  data.thresh <span class='op'>=</span> <span class='fl'>0</span>,
  more.than <span class='op'>=</span> <span class='cn'>TRUE</span>,
  cols <span class='op'>=</span> <span class='st'>"default"</span>,
  nbin <span class='op'>=</span> <span class='fl'>256</span>,
  auto.text <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>polar</th>
      <td><p>A data frame minimally containing <code>date</code> and at least
three other numeric variables, typically <code>ws</code>, <code>wd</code> and a
<code>pollutant</code>.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>x-axis variable. Mandatory.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>y-axis variable. Mandatory</p></td>
    </tr>
    <tr>
      <th>pollutant</th>
      <td><p>Mandatory. A pollutant name corresponding to a variable in
a data frame should be supplied e.g. <code>pollutant = "nox"</code></p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>The type of analysis to be done. The default is will produce a
single plot using the entire data. Other types include "hour" (for hour
of the day), "weekday" (for day of the week) and "month" (for month of
the year), "year" for a polarPlot for each year. It is also possible to
choose <code>type</code> as another variable in the data frame. For example,
<code>type = "o3"</code> will plot four kernel exceedance plots for different
levels of ozone, split into four quantiles (approximately equal numbers
of counts in each of the four splits). This offers great flexibility for
understanding the variation of different variables dependent on another.
See function <code>cutData</code> for further details.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p><code>by</code> determines how data above the <code>limit</code> are
selected. <code>by = "day"</code> will select <em>all</em> data (typically hours)
on days where the daily mean value is above <code>limit</code>. <code>by =
"dayhour"</code> will select only those data above <code>limit</code> on days where
the daily mean value is above <code>limit</code>. <code>by = "hour"</code> will
select all data above <code>limit</code>.</p></td>
    </tr>
    <tr>
      <th>limit</th>
      <td><p>The threshold above which the <code>pollutant</code> concentration
will be considered.</p></td>
    </tr>
    <tr>
      <th>data.thresh</th>
      <td><p>The data capture threshold to use (<!-- %) when aggregating -->
the data using <code>timeAverage</code> to daily means. A value of zero means
that all available data will be used in a particular period regardless if
of the number of values available. Conversely, a value of 100 will mean
that all data will need to be present for the average to be calculated,
else it is recorded as <code>NA</code>.</p></td>
    </tr>
    <tr>
      <th>more.than</th>
      <td><p>If <code>TRUE</code> data will be selected that are greater than
<code>limit</code>. If <code>FALSE</code> data will be selected that less than
<code>limit</code>.</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>Colours to be used for plotting. Options include "default",
"increment", "heat", "spectral", "hue", "brewer1" and user defined (see
manual for more details). The same line colour can be set for all
pollutant e.g. <code>cols = "black"</code>.</p></td>
    </tr>
    <tr>
      <th>nbin</th>
      <td><p>number of bins to be used for the kernel density estimate.</p></td>
    </tr>
    <tr>
      <th>auto.text</th>
      <td><p>Either <code>TRUE</code> (default) or <code>FALSE</code>. If
<code>TRUE</code> titles and axis labels will automatically try and format
pollutant names and units properly e.g.  by subscripting the `2' in NO2.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other graphical parameters passed onto <code>lattice:levelplot</code>
and <code>cutData</code>. For example, <code>kernelExceed</code> passes the option
<code>hemisphere = "southern"</code> on to <code>cutData</code> to provide southern
(rather than default northern) hemisphere handling of <code>type = "season"</code>.
Similarly, common axis and title labelling options (such as <code>xlab</code>,
<code>ylab</code>, <code>main</code>) are passed to <code>levelplot</code> via <code>quickText</code>
to handle routine formatting.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>To be completed.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>kernelExceed</code> functions is for exploring the conditions under
which exceedances of air pollution limits occur. Currently it is focused on
the daily mean (European) Limit Value for PM10 of 50~ug/m3 not to be
exceeded on more than 35 days. However, the function is sufficiently
flexible to consider other limits e.g. could be used to explore days where
the daily mean are greater than 100~ug/m3.</p>
<p>By default the function will plot the kernel density estimate of wind speed
and wind directions for all days where the concentration of
<code>pollutant</code> is greater than <code>limit</code>. Understanding the conditions
where exceedances occur can help with source identification.</p>
<p>The function offers different ways of selecting the data on days where the
<code>pollutant</code> are greater than <code>limit</code> through setting <code>by</code>.
By default it will select all data on days where <code>pollutant</code> is
greater than <code>limit</code>. With the default setting of <code>by</code> it will
select all data on those days where <code>pollutant</code> is greater than
<code>limit</code>, even if individual data (e.g. hours) are less than
<code>limit</code>. Setting <code>by = "dayhour"</code> will additionally ensure that
all data on the those dates are also greater than <code>limit</code>. Finally,
<code>by = "all"</code> will select all values of <code>pollutant</code> above limit,
regardless of when they occur.</p>
<p>The usefulness of the function is greatly enhanced through using
<code>type</code>, which conditions the data according to the level of another
variable. For example, <code>type = "season"</code> will show the kernel density
estimate by spring, summer, autumn and winter and <code>type = "so2"</code> will
attempt to show the kernel density estimates by quantiles of SO2
concentration. By considering different values of <code>type</code> it is
possible to develop a good understanding of the conditions under which
exceedances occur.</p>
<p>To aid interpretation the plot will also show the <em>estimated</em> number
of days or hours where exeedances occur. For <code>type = "default"</code> the
number of days should exactly correspond to the actual number of exceedance
days. However, with different values of <code>type</code> the number of days is
an estimate. It is an estimate because conditioning breaks up individual
days and the estimate is based on the proportion of data calculated for
each level of <code>type</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function automatically chooses the bandwidth for the kernel
  density estimate. We generally find that most data sets are not overly
  sensitive to the choice of bandwidth. One important reason for this
  insensitivity is likley to be the characteristics of air pollution
  itself. Due to atmospheric dispersion processes, pollutant plumes
  generally mix rapidly in the atmosphere. This means that pollutant
  concentrations are &#8216;smeared-out&#8217; and extra fidelity brought about
  by narrower bandwidths do not recover any more detail.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='polarAnnulus.html'>polarAnnulus</a></code>, <code><a href='polarFreq.html'>polarFreq</a></code>,
  <code><a href='polarPlot.html'>polarPlot</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>David Carslaw</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='co'># Note! the manual contains other examples that are more illuminating</span></span>
<span class='r-in'><span class='co'># basic plot</span></span>
<span class='r-in'><span class='fu'>kernelExceed</span><span class='op'>(</span><span class='va'>mydata</span>, pollutant <span class='op'>=</span> <span class='st'>"pm10"</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> (loaded the KernSmooth namespace)</span>
<span class='r-plt img'><img src='kernelExceed-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># condition by NOx concentrations</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>kernelExceed</span><span class='op'>(</span><span class='va'>mydata</span>, pollutant <span class='op'>=</span> <span class='st'>"pm10"</span>, type <span class='op'>=</span> <span class='st'>"nox"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


