<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Trajectory line plots with conditioning — trajPlot • openair</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Trajectory line plots with conditioning — trajPlot" />
<meta property="og:description" content="This function plots back trajectories. This function requires that data are
imported using the importTraj function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openair</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Trajectory line plots with conditioning</h1>
    <small class="dont-index">Source: <a href='https://github.com/davidcarslaw/openair/blob/master/R/trajPlot.R'><code>R/trajPlot.R</code></a></small>
    <div class="hidden name"><code>trajPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function plots back trajectories. This function requires that data are
imported using the <code>importTraj</code> function.</p>
    </div>

    <pre class="usage"><span class='fu'>trajPlot</span><span class='op'>(</span>
  <span class='va'>mydata</span>,
  lon <span class='op'>=</span> <span class='st'>"lon"</span>,
  lat <span class='op'>=</span> <span class='st'>"lat"</span>,
  pollutant <span class='op'>=</span> <span class='st'>"height"</span>,
  type <span class='op'>=</span> <span class='st'>"default"</span>,
  map <span class='op'>=</span> <span class='cn'>TRUE</span>,
  group <span class='op'>=</span> <span class='cn'>NA</span>,
  map.fill <span class='op'>=</span> <span class='cn'>TRUE</span>,
  map.res <span class='op'>=</span> <span class='st'>"default"</span>,
  map.cols <span class='op'>=</span> <span class='st'>"grey40"</span>,
  map.alpha <span class='op'>=</span> <span class='fl'>0.4</span>,
  projection <span class='op'>=</span> <span class='st'>"lambert"</span>,
  parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>51</span>, <span class='fl'>51</span><span class='op'>)</span>,
  orientation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>90</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,
  grid.col <span class='op'>=</span> <span class='st'>"deepskyblue"</span>,
  npoints <span class='op'>=</span> <span class='fl'>12</span>,
  origin <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mydata</th>
      <td><p>Data frame, the result of importing a trajectory file using
<code>importTraj</code>.</p></td>
    </tr>
    <tr>
      <th>lon</th>
      <td><p>Column containing the longitude, as a decimal.</p></td>
    </tr>
    <tr>
      <th>lat</th>
      <td><p>Column containing the latitude, as a decimal.</p></td>
    </tr>
    <tr>
      <th>pollutant</th>
      <td><p>Pollutant to be plotted. By default the trajectory height
is used.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code>type</code> determines how the data are split i.e. conditioned,
  and then plotted. The default is will produce a single plot using the
  entire data. Type can be one of the built-in types as detailed in
  <code>cutData</code> e.g. "season", "year", "weekday" and so on. For example,
  <code>type = "season"</code> will produce four plots --- one for each season.</p>
<p>It is also possible to choose <code>type</code> as another variable in the data
  frame. If that variable is numeric, then the data will be split into four
  quantiles (if possible) and labelled accordingly. If type is an existing
  character or factor variable, then those categories/levels will be used
  directly. This offers great flexibility for understanding the variation of
  different variables and how they depend on one another.</p>
<p><code>type</code> can be up length two e.g. <code>type = c("season", "weekday")</code>
  will produce a 2x2 plot split by season and day of the week. Note, when
  two types are provided the first forms the columns and the second the
  rows.</p></td>
    </tr>
    <tr>
      <th>map</th>
      <td><p>Should a base map be drawn? If <code>TRUE</code> the world base map
from the <code>maps</code> package is used.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>It is sometimes useful to group and colour trajectories
according to a grouping variable. See example below.</p></td>
    </tr>
    <tr>
      <th>map.fill</th>
      <td><p>Should the base map be a filled polygon? Default is to fill
countries.</p></td>
    </tr>
    <tr>
      <th>map.res</th>
      <td><p>The resolution of the base map. By default the function uses
the &#8216;world&#8217; map from the <code>maps</code> package. If <code>map.res =
"hires"</code> then the (much) more detailed base map &#8216;worldHires&#8217; from
the <code>mapdata</code> package is used. Use <code><a href='https://rdrr.io/r/base/library.html'>library(mapdata)</a></code>. Also
available is a map showing the US states. In this case <code>map.res =
"state"</code> should be used.</p></td>
    </tr>
    <tr>
      <th>map.cols</th>
      <td><p>If <code>map.fill = TRUE</code> <code>map.cols</code> controls the fill
colour. Examples include <code>map.fill = "grey40"</code> and <code>map.fill =
openColours("default", 10)</code>. The latter colours the countries and can help
differentiate them.</p></td>
    </tr>
    <tr>
      <th>map.alpha</th>
      <td><p>The transpency level of the filled map which takes values
from 0 (full transparency) to 1 (full opacity). Setting it below 1 can
help view trajectories, trajectory surfaces etc. <em>and</em> a filled base
map.</p></td>
    </tr>
    <tr>
      <th>projection</th>
      <td><p>The map projection to be used. Different map projections
are possible through the <code>mapproj</code> package. See <code>?mapproject</code>
for extensive details and information on setting other parameters and
orientation (see below).</p></td>
    </tr>
    <tr>
      <th>parameters</th>
      <td><p>From the <code>mapproj</code> package. Optional numeric vector
of parameters for use with the projection argument. This argument is
optional only in the sense that certain projections do not require
additional parameters. If a projection does not require additional
parameters then set to null i.e. <code>parameters = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>orientation</th>
      <td><p>From the <code>mapproj</code> package. An optional vector
c(latitude, longitude, rotation) which describes where the "North Pole"
should be when computing the projection. Normally this is c(90, 0), which
is appropriate for cylindrical and conic projections. For a planar
projection, you should set it to the desired point of tangency. The third
value is a clockwise rotation (in degrees), which defaults to the midrange
of the longitude coordinates in the map.</p></td>
    </tr>
    <tr>
      <th>grid.col</th>
      <td><p>The colour of the map grid to be used. To remove the grid
set <code>grid.col = "transparent"</code>.</p></td>
    </tr>
    <tr>
      <th>npoints</th>
      <td><p>A dot is placed every <code>npoints</code> along each full
trajectory. For hourly back trajectories points are plotted every
<code>npoint</code> hours. This helps to understand where the air masses were at
particular times and get a feel for the speed of the air (points closer
togther correspond to slower moving air masses). If <code>npoints = NA</code>
then no points are added.</p></td>
    </tr>
    <tr>
      <th>origin</th>
      <td><p>If true a filled circle dot is shown to mark the receptor
point.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments are passed to <code>cutData</code> and
<code>scatterPlot</code>. This provides access to arguments used in both these
functions and functions that they in turn pass arguments on to. For
example, <code>plotTraj</code> passes the argument <code>cex</code> on to
<code>scatterPlot</code> which in turn passes it on to the <code>lattice</code>
function <code>xyplot</code> where it is applied to set the plot symbol size.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Several types of trajectory plot are available. <code>trajPlot</code> by default
will plot each lat/lon location showing the origin of each trajectory, if no
<code>pollutant</code> is supplied.</p>
<p>If a pollutant is given, by merging the trajectory data with concentration
data (see example below), the trajectories are colour-coded by the
concentration of <code>pollutant</code>. With a long time series there can be lots
of overplotting making it difficult to gauge the overall concentration
pattern. In these cases setting <code>alpha</code> to a low value e.g. 0.1 can
help.</p>
<p>The user can aslo show points instead of lines by <code>plot.type = "p"</code>.</p>
<p>Note that <code>trajPlot</code> will plot only the full length trajectories. This
should be remembered when selecting only part of a year to plot.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='importTraj.html'>importTraj</a></code> to import trajectory data from the King's
  College server and <code><a href='trajLevel.html'>trajLevel</a></code> for trajectory binning
  functions.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>David Carslaw</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='co'># show a simple case with no pollutant i.e. just the trajectories</span></span>
<span class='r-in'><span class='co'># let's check to see where the trajectories were coming from when</span></span>
<span class='r-in'><span class='co'># Heathrow Airport was closed due to the Icelandic volcanic eruption</span></span>
<span class='r-in'><span class='co'># 15--21 April 2010.</span></span>
<span class='r-in'><span class='co'># import trajectories for London and plot</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='va'>lond</span> <span class='op'>&lt;-</span> <span class='fu'><a href='importTraj.html'>importTraj</a></span><span class='op'>(</span><span class='st'>"london"</span>, <span class='fl'>2010</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># well, HYSPLIT seems to think there certainly were conditions where trajectories</span></span>
<span class='r-in'><span class='co'># orginated from Iceland...</span></span>
<span class='r-in'><span class='fu'>trajPlot</span><span class='op'>(</span><span class='fu'><a href='selectByDate.html'>selectByDate</a></span><span class='op'>(</span><span class='va'>lond</span>, start <span class='op'>=</span> <span class='st'>"15/4/2010"</span>, end <span class='op'>=</span> <span class='st'>"21/4/2010"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># plot by day, need a column that makes a date</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='va'>lond</span><span class='op'>$</span><span class='va'>day</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='va'>lond</span><span class='op'>$</span><span class='va'>date</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>trajPlot</span><span class='op'>(</span><span class='fu'><a href='selectByDate.html'>selectByDate</a></span><span class='op'>(</span><span class='va'>lond</span>, start <span class='op'>=</span> <span class='st'>"15/4/2010"</span>, end <span class='op'>=</span> <span class='st'>"21/4/2010"</span><span class='op'>)</span>,</span>
<span class='r-in'>type <span class='op'>=</span> <span class='st'>"day"</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># or show each day grouped by colour, with some other options set</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'> <span class='fu'>trajPlot</span><span class='op'>(</span><span class='fu'><a href='selectByDate.html'>selectByDate</a></span><span class='op'>(</span><span class='va'>lond</span>, start <span class='op'>=</span> <span class='st'>"15/4/2010"</span>, end <span class='op'>=</span> <span class='st'>"21/4/2010"</span><span class='op'>)</span>,</span>
<span class='r-in'>group <span class='op'>=</span> <span class='st'>"day"</span>, col <span class='op'>=</span> <span class='st'>"jet"</span>, lwd <span class='op'>=</span> <span class='fl'>2</span>, key.pos <span class='op'>=</span> <span class='st'>"right"</span>, key.col <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'><span class='co'># more examples to follow linking with concentration measurements...</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


