<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate common model evaluation statistics — modStats • openair</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate common model evaluation statistics — modStats" />
<meta property="og:description" content="Function to calculate common numerical model evaluation statistics with
flexible conditioning" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openair</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate common model evaluation statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/davidcarslaw/openair/blob/master/R/modStats.R'><code>R/modStats.R</code></a></small>
    <div class="hidden name"><code>modStats.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to calculate common numerical model evaluation statistics with
flexible conditioning</p>
    </div>

    <pre class="usage"><span class='fu'>modStats</span><span class='op'>(</span>
  <span class='va'>mydata</span>,
  mod <span class='op'>=</span> <span class='st'>"mod"</span>,
  obs <span class='op'>=</span> <span class='st'>"obs"</span>,
  statistic <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='st'>"FAC2"</span>, <span class='st'>"MB"</span>, <span class='st'>"MGE"</span>, <span class='st'>"NMB"</span>, <span class='st'>"NMGE"</span>, <span class='st'>"RMSE"</span>, <span class='st'>"r"</span>, <span class='st'>"COE"</span>, <span class='st'>"IOA"</span><span class='op'>)</span>,
  type <span class='op'>=</span> <span class='st'>"default"</span>,
  rank.name <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mydata</th>
      <td><p>A data frame.</p></td>
    </tr>
    <tr>
      <th>mod</th>
      <td><p>Name of a variable in <code>mydata</code> that respresents modelled
values.</p></td>
    </tr>
    <tr>
      <th>obs</th>
      <td><p>Name of a variable in <code>mydata</code> that respresents measured
values.</p></td>
    </tr>
    <tr>
      <th>statistic</th>
      <td><p>The statistic to be calculated. See details below
for a description of each.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code>type</code> determines how the data are split
i.e. conditioned, and then plotted. The default is will produce
statistics using the entire data. <code>type</code> can be one of the
built-in types as detailed in <code>cutData</code> e.g. &#8220;season&#8221;,
&#8220;year&#8221;, &#8220;weekday&#8221; and so on. For example, <code>type
= "season"</code> will produce four sets of statistics --- one for each
season.</p>
<p>It is also possible to choose <code>type</code> as another variable in
the data frame. If that variable is numeric, then the data will be
split into four quantiles (if possible) and labelled
accordingly. If type is an existing character or factor variable,
then those categories/levels will be used directly. This offers
great flexibility for understanding the variation of different
variables and how they depend on one another.</p>
<p>More than one type can be considered e.g. <code>type = c("season",
"weekday")</code> will produce statistics split by season and day of the
week.</p></td>
    </tr>
    <tr>
      <th>rank.name</th>
      <td><p>Simple model ranking can be carried out if
<code>rank.name</code> is supplied. <code>rank.name</code> will generally
refer to a column representing a model name, which is to
ranked. The ranking is based the COE performance, as that
indicator is arguably the best single model performance indicator
available.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other aruments to be passed to <code>cutData</code> e.g.
<code>hemisphere = "southern"</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a data frame with model evaluation statistics.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is under development and currently provides some common model
evaluation statistics. These include (to be mathematically defined later):</p>
<ul>
<li><p>\(n\), the number of complete pairs of data.</p></li>
<li><p>\(FAC2\), fraction of predictions within a factor of two.</p></li>
<li><p>\(MB\), the mean bias.</p></li>
<li><p>\(MGE\), the mean gross error.</p></li>
<li><p>\(NMB\), the normalised mean bias.</p></li>
<li><p>\(NMGE\), the normalised mean gross error.</p></li>
<li><p>\(RMSE\), the root mean squared error.</p></li>
<li><p>\(r\), the Pearson correlation coefficient. Note, can also
supply and aurument <code>method</code> e.g. <code>method = "spearman"</code></p></li>
<li><p>\(COE\), the <em>Coefficient of Efficiency</em> based on
Legates and McCabe (1999, 2012). There have been many suggestions
for measuring model performance over the years, but the COE is a
simple formulation which is easy to interpret.</p>
<p>A perfect model has a COE = 1. As noted by Legates and McCabe
although the COE has no lower bound, a value of COE = 0.0 has a
fundamental meaning. It implies that the model is no more able to
predict the observed values than does the observed
mean. Therefore, since the model can explain no more of the
variation in the observed values than can the observed mean, such
a model can have no predictive advantage.</p>
<p>For negative values of COE, the model is less effective than the
observed mean in predicting the variation in the
observations.</p></li>
<li><p>\(IOA\), the Index of Agreement based on Willmott et
al. (2011), which spans between -1 and +1 with values approaching
+1 representing better model performance.</p>
<p>An IOA of 0.5, for example, indicates that the sum of the
error-magnitudes is one half of the sum of the observed-deviation
magnitudes.  When IOA = 0.0, it signifies that the sum of the
magnitudes of the errors and the sum of the observed-deviation
magnitudes are equivalent. When IOA = -0.5, it indicates that the
sum of the error-magnitudes is twice the sum of the perfect
model-deviation and observed-deviation magnitudes. Values of IOA
near -1.0 can mean that the model-estimated deviations about O are
poor estimates of the observed deviations; but, they also can mean
that there simply is little observed variability - so some caution
is needed when the IOA approaches -1.</p></li>
</ul>

<p>All statistics are based on complete pairs of <code>mod</code> and <code>obs</code>.</p>
<p>Conditioning is possible through setting <code>type</code>, which can be
a vector e.g. <code>type = c("weekday", "season")</code>.</p>
<p>Details of the formulas are given in the openair manual.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Legates DR, McCabe GJ. (1999). Evaluating the use of goodness-of-fit
measures in hydrologic and hydroclimatic model validation. Water
Resources Research 35(1): 233-241.</p>
<p>Legates DR, McCabe GJ. (2012). A refined index of model
performance: a rejoinder, International Journal of Climatology.</p>
<p>Willmott, C.J., Robeson, S.M., Matsuura, K., 2011. A
refined index of model performance. International Journal of
Climatology.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>David Carslaw</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='co'>## the example below is somewhat artificial --- assuming the observed</span></span>
<span class='r-in'><span class='co'>## values are given by NOx and the predicted values by NO2.</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>modStats</span><span class='op'>(</span><span class='va'>mydata</span>, mod <span class='op'>=</span> <span class='st'>"no2"</span>, obs <span class='op'>=</span> <span class='st'>"nox"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    default     n      FAC2        MB      MGE        NMB     NMGE     RMSE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 all data 63095 0.1703868 -129.6739 129.7277 -0.7252306 0.725532 166.6203</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>           r        COE       IOA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 0.7874487 -0.3374671 0.3312664</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## evaluation stats by season</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>modStats</span><span class='op'>(</span><span class='va'>mydata</span>, mod <span class='op'>=</span> <span class='st'>"no2"</span>, obs <span class='op'>=</span> <span class='st'>"nox"</span>, type <span class='op'>=</span> <span class='st'>"season"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>         season     n       FAC2        MB      MGE        NMB      NMGE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 spring (MAM) 17343 0.25763083 -107.5466 107.5466 -0.6846951 0.6846951</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3 summer (JJA) 14658 0.17140113 -116.2004 116.2004 -0.7053470 0.7053470</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 autumn (SON) 14775 0.09825963 -154.1534 154.1534 -0.7526324 0.7526324</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4 winter (DJF) 16319 0.14201438 -143.1283 143.3366 -0.7494609 0.7505519</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       RMSE         r        COE       IOA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 139.9177 0.8196724 -0.2497589 0.3751205</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3 144.7206 0.7568891 -0.4197370 0.2901315</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 191.9351 0.7881365 -0.4370783 0.2814608</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4 185.3849 0.8260512 -0.3207156 0.3396422</span>
<span class='r-in'></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


